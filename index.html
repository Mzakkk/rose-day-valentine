<script>
/* =========================
   BLACK HEARTS (SMOOTH + LIMITED)
========================= */
const canvas = document.getElementById("bg");
const ctx = canvas.getContext("2d");

function resize(){
    canvas.width = innerWidth;
    canvas.height = innerHeight;
}
resize();
addEventListener("resize", resize);

const hearts = [];
const INITIAL_HEARTS = 40;
const MAX_HEARTS = 120;
const LINK_DISTANCE = 130;

class Heart{
    constructor(x,y){
        this.x = x ?? Math.random()*canvas.width;
        this.y = y ?? Math.random()*canvas.height;
        this.vx = (Math.random()-0.5)*0.35;   // slower
        this.vy = (Math.random()-0.5)*0.35;
        this.size = 12;
        this.alpha = 0;                       // fade-in
        this.cooldown = false;                // prevent spam
    }

    move(){
        this.x += this.vx;
        this.y += this.vy;

        if(this.x<0||this.x>canvas.width) this.vx*=-1;
        if(this.y<0||this.y>canvas.height) this.vy*=-1;

        if(this.alpha < 1) this.alpha += 0.02;
    }

    draw(){
        ctx.globalAlpha = this.alpha;
        ctx.font = this.size+"px serif";
        ctx.fillText("ðŸ–¤", this.x, this.y);
        ctx.globalAlpha = 1;
    }
}

// initial hearts
for(let i=0;i<INITIAL_HEARTS;i++) hearts.push(new Heart());

canvas.addEventListener("click", e=>{
    if(hearts.length >= MAX_HEARTS) return;

    hearts.forEach(h=>{
        const d = Math.hypot(h.x-e.clientX, h.y-e.clientY);

        if(d < 25 && !h.cooldown){
            hearts.push(new Heart(h.x, h.y));
            h.cooldown = true;

            // reset cooldown
            setTimeout(()=>h.cooldown=false,600);
        }
    });
});

function animate(){
    ctx.clearRect(0,0,canvas.width,canvas.height);

    hearts.forEach(h=>{
        h.move();
        h.draw();
    });

    for(let i=0;i<hearts.length;i++){
        for(let j=i+1;j<hearts.length;j++){
            const d = Math.hypot(
                hearts[i].x-hearts[j].x,
                hearts[i].y-hearts[j].y
            );

            if(d < LINK_DISTANCE){
                ctx.strokeStyle = "rgba(0,0,0,0.15)";
                ctx.beginPath();
                ctx.moveTo(hearts[i].x, hearts[i].y);
                ctx.lineTo(hearts[j].x, hearts[j].y);
                ctx.stroke();
            }
        }
    }

    requestAnimationFrame(animate);
}
animate();
</script>
